"0","#python"
"0","Data = pd.merge(HLA,peptide)"
"0","IMM_train_data_allele = pd.read_csv(""../data/IEDB_MHCII_immuno_allele.csv"",header = None,names = [""HLA""])"
"0","Data = Data[Data[""HLA""].isin(IMM_train_data_allele[""HLA""])]"
"0","pseudo_seq = pd.read_table(""../data/pseudosequence.2016.all.X.dat"",header = None,names = [""HLA"",""sequence""])"
"0","Data1 = pd.merge(Data,pseudo_seq)"
"0","Data1[""length""] = Data1[""Peptide""].map(len)"
"0","Data1 = Data1[Data1[""length""]>=13]"
"0","Data1 = Data1.reset_index(drop = True)"
"0","#15mer"
"0","def mer15(Pep):"
"0","    P = []"
"0","    Length = 15"
"0","    for i in range(len(Pep) - Length +1):"
"0","        pep = Pep[i:i+Length]"
"0","        P.append(pep)"
"0","    return P"
"0","DF15 = pd.DataFrame()"
"0","for i in range(len(Data1)):"
"0","    pep = mer15(Data1[""Peptide""][i])"
"0","    df = pd.DataFrame(pep)"
"0","    df[""pep_ID""] = Data1[""pep_ID""][i]"
"0","    df[""HLA""] = Data1[""HLA""][i]"
"0","    DF15 = pd.concat([DF15,df])"
"0","DF15.columns = [""pep"",""pep_ID"",""HLA""]"
"0","benchmark_data = pd.merge(DF15,pseudo_seq)"
"0","benchmark_data.to_csv(""../data/15mer_data.csv"")"
"0","benchmark_data[""pep""].to_csv(""../data/15mer_pep_only.txt"",header = None,index = None,sep = "" "")"
"0","#kmer"
"0","def kmer(Pep,sa,end):"
"0","    P = []"
"0","    R = range(sa,end+1)"
"0","    for i in R:"
"0","        Length = i"
"0","        for i in range(len(Pep) - Length +1):"
"0","            pep = Pep[i:i+Length]"
"0","            P.append(pep)"
"0","    return P"
"0","DF_k = pd.DataFrame()"
"0","for i in range(len(Data1)):"
"0","    pep = kmer(Data1[""Peptide""][i],13,21)"
"0","    df = pd.DataFrame(pep)"
"0","    df[""pep_ID""] = Data1[""pep_ID""][i]"
"0","    df[""HLA""] = Data1[""HLA""][i]"
"0","    DF_k = pd.concat([DF_k,df])"
"0","DF_k.columns = [""pep"",""pep_ID"",""HLA""]"
"0","benchmark_data = pd.merge(DF_k,pseudo_seq)"
"0","benchmark_data.to_csv(""../data/kmer_data.csv"")"
